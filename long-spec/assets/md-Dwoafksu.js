import{b as l,o as a,w as r,g as t,ad as e,v as u,x as d,T as s}from"./modules/vue-CExxo5Y-.js";import{I as c}from"./slidev/default-D_bHMWDv.js";import{u as g,f as m}from"./slidev/context-BzMuSdlI.js";import"./index-BoNHALzr.js";import"./modules/shiki-3ci1IloS.js";const p="/long-spec/assets/method2-CuGKNa9z.png",w={__name:"slides.md__slidev_9",setup(f){const{$clicksContext:i,$frontmatter:o}=g();return i.setup(),(h,n)=>(a(),l(c,u(d(s(m)(s(o),8))),{default:r(()=>[...n[0]||(n[0]=[t("h1",null,"Solution",-1),t("p",null,"Anchor-Offset Indices",-1),t("div",{class:"flex gap-4"},[t("div",{class:"grow"},[t("ul",null,[t("li",null,[t("strong",null,"The Problem:"),e(" Draft models are trained on short data, but inference requires handling long position indices (e.g., token 100,000). Standard RoPE extrapolation fails because the target modelâ€™s base is fixed.")]),t("li",null,[t("strong",null,"The Strategy:"),t("ul",null,[t("li",null,[t("strong",null,"Simulated Long Positions:"),e(" During short-sequence training, the model reserves the first few tokens as "),t("strong",null,"Anchors"),e(" (indices 0-3) to capture attention sinks.")]),t("li",null,[t("strong",null,"Random Offsets:"),e(" For subsequent tokens, it assigns large, random position indices (e.g., jumping to index 8192+) to simulate long-context distribution.")]),t("li",null,[t("strong",null,"Flash Noisy Training:"),e(" A technique that randomly shifts indices during training to simulate the visibility constraints (cache vs. speculation) seen during inference, without breaking Flash Attention compatibility.")])])])])]),t("div",null,[t("img",{src:p,class:"w-250"})])],-1)])]),_:1},16))}};export{w as default};
