import{_ as te,a as oe,b as ne,c as re,d as se}from"../modules/unplugin-icons-DMCjz482.js";import{t as b,a0 as le,y as h,A as K,d as M,a1 as ie,a2 as ae,a3 as ce,D as I,C as de,a4 as ue,n as me,o as u,c as x,i as f,h as y,a5 as G,a6 as Q,b as g,j as _e,e as l,l as p,F as V,x as z,g as D,Z as pe,p as W,a as X,M as fe,a7 as ve,J as xe,a8 as ge,a9 as he,k as F}from"../modules/vue-jJv3i-5y.js";import{b as O,C as ke,e as be,c as U,h as ye,j as Se,d as Ce,k as we}from"../index-CzxDjOKc.js";import{r as Ne,u as Fe,S as ze,N as De,Q as Ie,G as Me,a as Oe,I as Te}from"./SlidesShow-BiWNFLHv.js";import{s as je,d as Pe,i as He,p as Ee,b as Le,c as Ve,e as Be,g as qe,S as Re}from"./bottom-C_cAqf8k.js";import{N as J}from"./NoteDisplay-CR_ZWblN.js";import Ae from"./DrawingControls-CzcjQA-5.js";import{u as Ke}from"./DrawingPreview-DfKYBNxk.js";import"../modules/shiki-DNME4isg.js";import"./context-DLoM1jUq.js";function Z(r){if(r==null)return{info:b(),update:async()=>{}};const t=`/@slidev/slide/${r}.json`,{data:n,execute:e}=le(t).json().get();return e(),{info:n,update:async s=>await fetch(t,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then(a=>a.json())}}const L={};function Ue(r){function t(n){return L[n]??(L[n]=Z(n))}return{info:h(()=>t(K(r)).info.value),update:async(n,e)=>{const i=t(e??K(r)),s=await i.update(n);return s&&(i.info.value=s),s}}}const Ge=M({__name:"NoteEditable",props:{no:{type:Number,required:!0},class:{default:""},editing:{default:!1},style:{default:()=>({})},placeholder:{default:"No notes for this slide"},clicksContext:{type:Object},autoHeight:{default:!1}},emits:["update:editing","markerDblclick","markerClick"],setup(r,{expose:t,emit:n}){t();const e=r,i=n,s=ie(e,"editing",i,{passive:!0}),{info:a,update:o}=Ue(ae(e,"no")),c=b("");let _;const{ignoreUpdates:v}=ce(c,m=>{if(!s.value)return;const T=e.no;clearTimeout(_),_=setTimeout(()=>{o({note:m},T)},500)});I(()=>{var m;return(m=a.value)==null?void 0:m.note},(m="")=>{s.value||(clearTimeout(_),v(()=>{c.value=m}))},{immediate:!0,flush:"sync"});const d=b(),C=b();de(()=>{var m;s.value&&((m=d.value)==null||m.focus())}),ue(d,()=>{s.value=!1});function S(){!e.autoHeight||!d.value||!s.value||d.value.scrollHeight>d.value.clientHeight&&(d.value.style.height=`${d.value.scrollHeight}px`)}I([c,s],()=>{me(()=>{S()})},{flush:"post",immediate:!0});const w={props:e,emit:i,editing:s,info:a,update:o,note:c,get timer(){return _},set timer(m){_=m},ignoreUpdates:v,inputEl:d,inputHeight:C,calculateEditorHeight:S,NoteDisplay:J};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),Qe=["placeholder"];function We(r,t,n,e,i,s){var a;return e.editing?G((u(),g("textarea",{key:1,ref:"inputEl","onUpdate:modelValue":t[2]||(t[2]=o=>e.note=o),class:f(["prose resize-none overflow-auto outline-none bg-transparent block border-primary border-2",e.props.class]),style:y([{"line-height":"1.75"},[e.props.style,e.inputHeight!=null?{height:`${e.inputHeight}px`}:{}]]),placeholder:n.placeholder,onKeydown:t[3]||(t[3]=_e(o=>e.editing=!1,["esc"]))},null,46,Qe)),[[Q,e.note]]):(u(),x(e.NoteDisplay,{key:0,class:f(["border-transparent border-2",[e.props.class,e.note?"":"opacity-25 italic select-none"]]),style:y(e.props.style),note:e.note||n.placeholder,"note-html":(a=e.info)==null?void 0:a.noteHTML,"clicks-context":n.clicksContext,"auto-scroll":!n.autoHeight,onMarkerClick:t[0]||(t[0]=(o,c)=>e.emit("markerClick",o,c)),onMarkerDblclick:t[1]||(t[1]=(o,c)=>e.emit("markerDblclick",o,c))},null,8,["class","style","note","note-html","clicks-context","auto-scroll"]))}const Xe=O(Ge,[["render",We],["__file","/home/runner/work/slides/slides/node_modules/.pnpm/@slidev+client@0.48.1_postcss@8.4.42_vite@5.4.2/node_modules/@slidev/client/internals/NoteEditable.vue"]]),Je=M({__name:"NoteStatic",props:{no:{type:Number,required:!0},class:{type:String,required:!1},clicksContext:{type:Object,required:!1}},setup(r,{expose:t}){t();const n=r,{info:e}=Z(n.no),i={props:n,info:e,NoteDisplay:J};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}});function Ze(r,t,n,e,i,s){var a,o;return u(),x(e.NoteDisplay,{class:f(e.props.class),note:(a=e.info)==null?void 0:a.note,"note-html":(o=e.info)==null?void 0:o.noteHTML,"clicks-context":n.clicksContext},null,8,["class","note","note-html","clicks-context"])}const Ye=O(Je,[["render",Ze],["__file","/home/runner/work/slides/slides/node_modules/.pnpm/@slidev+client@0.48.1_postcss@8.4.42_vite@5.4.2/node_modules/@slidev/client/internals/NoteStatic.vue"]]),$e=M({__name:"ClicksSlider",props:{clicksContext:{type:Object,required:!0}},setup(r,{expose:t}){t();const n=r,e=h(()=>n.clicksContext.total),i=h({get(){return n.clicksContext.current>e.value?-1:n.clicksContext.current},set(c){n.clicksContext.current=c}}),s=h(()=>Array.from({length:e.value+1},(c,_)=>_));function a(){(i.value<0||i.value>e.value)&&(i.value=0)}const o={props:n,total:e,current:i,range:s,onMousedown:a,get CLICKS_MAX(){return ke}};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}}),Y=r=>(W("data-v-f789b7bd"),r=r(),X(),r),et=["title"],tt={class:"flex gap-1 items-center min-w-16 tabular-nums"},ot=Y(()=>l("div",{"flex-auto":""},null,-1)),nt={"text-primary":""},rt=Y(()=>l("span",{op25:""},"/",-1)),st={op50:""},lt=["max"];function it(r,t,n,e,i,s){const a=te;return u(),g("div",{class:f(["flex gap-0.5 items-center select-none",e.total?"":"op50"]),title:`Clicks in this slide: ${e.total}`},[l("div",tt,[p(a,{"text-sm":"",op50:""}),e.current>=0&&e.current!==e.CLICKS_MAX?(u(),g(V,{key:0},[ot,l("span",nt,z(e.current),1),rt],64)):D("v-if",!0),l("span",st,z(e.total),1)]),l("div",{relative:"","flex-auto":"",h5:"",flex:"~",onDblclick:t[2]||(t[2]=o=>e.current=n.clicksContext.total)},[(u(!0),g(V,null,pe(e.range,o=>(u(),g("div",{key:o,border:"y main","of-hidden":"",relative:"",class:f([o===0?"rounded-l border-l":"",o===e.total?"rounded-r border-r":""]),style:y({width:e.total>0?`${1/e.total*100}%`:"100%"})},[l("div",{absolute:"","inset-0":"",class:f(o<=e.current?"bg-primary op20":"")},null,2),l("div",{class:f([+o==+e.current?"text-primary font-bold op100 border-primary":"op30 border-main",o===0?"rounded-l":"",o===e.total?"rounded-r":"border-r-2"]),"w-full":"","h-full":"","text-xs":"",flex:"","items-center":"","justify-center":"","z-1":""},z(o),3)],6))),128)),G(l("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>e.current=o),class:"range",absolute:"","inset-0":"",type:"range",min:0,max:e.total,step:1,"z-10":"",op0:"",style:y({"--thumb-width":`${1/(e.total+1)*100}%`}),onMousedown:e.onMousedown,onFocus:t[1]||(t[1]=o=>{var c;return(c=o.currentTarget)==null?void 0:c.blur()})},null,44,lt),[[Q,e.current]])],32)],10,et)}const at=O($e,[["render",it],["__scopeId","data-v-f789b7bd"],["__file","/home/runner/work/slides/slides/node_modules/.pnpm/@slidev+client@0.48.1_postcss@8.4.42_vite@5.4.2/node_modules/@slidev/client/internals/ClicksSlider.vue"]]),ct=M({__name:"presenter",setup(r,{expose:t}){t();const n=b();Ne(),Fe(n);const{clicksContext:e,currentSlideNo:i,currentSlideRoute:s,hasNext:a,nextRoute:o,slides:c,queryClicks:_,getPrimaryClicks:v,total:d}=be(),{isDrawing:C}=Ke(),S=U.titleTemplate.replace("%s",U.title||"Slidev");ye({title:`Presenter - ${S}`});const w=b(!1),{timer:m,resetTimer:T}=Se(),q=h(()=>c.value.map(P=>Ce(P))),N=h(()=>e.value.current<e.value.total?[s.value,e.value.current+1]:a.value?[o.value,0]:null),j=h(()=>N.value&&q.value[N.value[0].no-1]);I([s,_],()=>{j.value&&(j.value.current=N.value[1])},{immediate:!0});const $=fe();ve(()=>{const P=n.value.querySelector("#slide-content"),A=xe(ge()),ee=he();I(()=>{if(!ee.value||C.value||!je.value)return;const k=P.getBoundingClientRect(),H=(A.x-k.left)/k.width*100,E=(A.y-k.top)/k.height*100;if(!(H<0||H>100||E<0||E>100))return{x:H,y:E}},k=>{we.cursor=k})});const R={main:n,clicksContext:e,currentSlideNo:i,currentSlideRoute:s,hasNext:a,nextRoute:o,slides:c,queryClicks:_,getPrimaryClicks:v,total:d,isDrawing:C,slideTitle:S,notesEditing:w,timer:m,resetTimer:T,clicksCtxMap:q,nextFrame:N,nextFrameClicksCtx:j,SideEditor:$,get decreasePresenterFontSize(){return Pe},get increasePresenterFontSize(){return He},get presenterLayout(){return Ee},get presenterNotesFontSize(){return Le},get showEditor(){return Ve},get showOverview(){return Be},get getSlideClass(){return qe},SlideWrapper:Re,SlideContainer:ze,NavControls:De,QuickOverview:Ie,NoteEditable:Xe,NoteStatic:Ye,Goto:Me,SlidesShow:Oe,DrawingControls:Ae,IconButton:Te,ClicksSlider:at};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}}),B=r=>(W("data-v-028e10a2"),r=r(),X(),r),dt={class:"bg-main h-full slidev-presenter"},ut={ref:"main",class:"relative grid-section main flex flex-col"},mt=B(()=>l("div",{class:"absolute left-0 top-0 bg-main border-b border-r border-main px2 py1 op50 text-sm"}," Current ",-1)),_t={class:"relative grid-section next flex flex-col p-2 lg:p-4"},pt=B(()=>l("div",{class:"absolute left-0 top-0 bg-main border-b border-r border-main px2 py1 op50 text-sm"}," Next ",-1)),ft={key:1,class:"grid-section note grid grid-rows-[1fr_min-content] overflow-hidden"},vt={class:"border-t border-main py-1 px-2 text-sm"},xt={class:"grid-section bottom flex"},gt=B(()=>l("div",{"flex-auto":""},null,-1)),ht={class:"text-2xl pl-2 pr-6 my-auto tabular-nums"},kt={class:"progress-bar"};function bt(r,t,n,e,i,s){var v;const a=oe,o=ne,c=re,_=se;return u(),g(V,null,[l("div",dt,[l("div",{class:f(["grid-container",`layout${e.presenterLayout}`])},[l("div",ut,[p(e.SlideContainer,{key:"main",class:"h-full w-full p-2 lg:p-4 flex-auto"},{default:F(()=>[p(e.SlidesShow,{"render-context":"presenter"})]),_:1}),(u(),x(e.ClicksSlider,{key:(v=e.currentSlideRoute)==null?void 0:v.no,"clicks-context":e.getPrimaryClicks(e.currentSlideRoute),class:"w-full pb2 px4 flex-none"},null,8,["clicks-context"])),mt],512),l("div",_t,[e.nextFrame&&e.nextFrameClicksCtx?(u(),x(e.SlideContainer,{key:"next",class:"h-full w-full"},{default:F(()=>[(u(),x(e.SlideWrapper,{is:e.nextFrame[0].component,key:e.nextFrame[0].no,"clicks-context":e.nextFrameClicksCtx,class:f(e.getSlideClass(e.nextFrame[0])),route:e.nextFrame[0],"render-context":"previewNext"},null,8,["is","clicks-context","class","route"]))]),_:1})):D("v-if",!0),pt]),D(" Notes "),(u(),g("div",ft,[(u(),x(e.NoteStatic,{key:`static-${e.currentSlideNo}`,no:e.currentSlideNo,class:"w-full max-w-full h-full overflow-auto p-2 lg:p-4",style:y({fontSize:`${e.presenterNotesFontSize}em`}),"clicks-context":e.clicksContext},null,8,["no","style","clicks-context"])),l("div",vt,[p(e.IconButton,{title:"Increase font size",onClick:e.increasePresenterFontSize},{default:F(()=>[p(a)]),_:1},8,["onClick"]),p(e.IconButton,{title:"Decrease font size",onClick:e.decreasePresenterFontSize},{default:F(()=>[p(o)]),_:1},8,["onClick"]),D("v-if",!0)])])),l("div",xt,[p(e.NavControls,{persist:!0}),gt,l("div",{class:"timer-btn my-auto relative w-22px h-22px cursor-pointer text-lg",opacity:"50 hover:100",onClick:t[2]||(t[2]=(...d)=>e.resetTimer&&e.resetTimer(...d))},[p(c,{class:"absolute"}),p(_,{class:"absolute opacity-0"})]),l("div",ht,z(e.timer),1)]),(u(),x(e.DrawingControls,{key:2}))],2),l("div",kt,[l("div",{class:"progress h-3px bg-primary transition-all",style:y({width:`${(e.currentSlideNo-1)/(e.total-1)*100}%`})},null,4)])]),p(e.Goto),p(e.QuickOverview,{modelValue:e.showOverview,"onUpdate:modelValue":t[3]||(t[3]=d=>e.showOverview=d)},null,8,["modelValue"])],64)}const Ot=O(ct,[["render",bt],["__scopeId","data-v-028e10a2"],["__file","/home/runner/work/slides/slides/node_modules/.pnpm/@slidev+client@0.48.1_postcss@8.4.42_vite@5.4.2/node_modules/@slidev/client/pages/presenter.vue"]]);export{Ot as default};
